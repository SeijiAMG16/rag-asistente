{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{query as queryApi,syncDrive,uploadPdf,getConversations,getMessages}from'./api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Chat=_ref=>{let{onLogout}=_ref;const[message,setMessage]=useState('');const[messages,setMessages]=useState([]);const[isLoading,setIsLoading]=useState(false);const[conversations,setConversations]=useState([]);const[activeConversation,setActiveConversation]=useState(null);const[sidebarOpen,setSidebarOpen]=useState(true);const[actionMsg,setActionMsg]=useState(\"\");const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(()=>{scrollToBottom();},[messages]);// Cargar conversaciones al montar\nuseEffect(()=>{(async()=>{try{const res=await getConversations();const list=res.conversations||[];setConversations(list);if(list.length>0)setActiveConversation(list[0].id);}catch(e){console.error('No se pudieron cargar conversaciones',e);}})();},[]);// Cargar mensajes al cambiar de conversaci√≥n\nuseEffect(()=>{if(!activeConversation){setMessages([]);return;}(async()=>{try{const res=await getMessages(activeConversation);const msgs=(res.messages||[]).map(m=>({id:m.id,text:m.text,sender:m.sender,timestamp:new Date(m.created_at).toLocaleTimeString()}));setMessages(msgs);}catch(e){console.error('No se pudieron cargar mensajes',e);setMessages([]);}})();},[activeConversation]);const handleSubmit=async e=>{e.preventDefault();if(!message.trim())return;const userMessage={id:Date.now(),text:message,sender:'user',timestamp:new Date().toLocaleTimeString()};setMessages(prev=>[...prev,userMessage]);setMessage('');setIsLoading(true);try{const response=await queryApi(message,5,activeConversation||undefined);const botMessage={id:Date.now()+1,text:response.answer,sender:'bot',timestamp:new Date().toLocaleTimeString(),sources:response.sources||[]};setMessages(prev=>[...prev,botMessage]);// Actualizar conversaci√≥n activa si el backend la cre√≥\nif(!activeConversation&&response.conversation_id){setActiveConversation(response.conversation_id);// refrescar lista de conversaciones\ntry{const r=await getConversations();setConversations(r.conversations||[]);}catch(_unused){}}}catch(error){console.error('Error:',error);const errorMessage={id:Date.now()+1,text:'Error al procesar la consulta. Intenta nuevamente.',sender:'bot',timestamp:new Date().toLocaleTimeString(),isError:true};setMessages(prev=>[...prev,errorMessage]);}finally{setIsLoading(false);}};const startNewConversation=()=>{setMessages([]);setActiveConversation(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar \".concat(sidebarOpen?'open':'closed'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"toggle-sidebar\",onClick:()=>setSidebarOpen(!sidebarOpen),children:sidebarOpen?'‚Üê':'‚Üí'}),sidebarOpen&&/*#__PURE__*/_jsx(\"button\",{className:\"new-chat-btn\",onClick:startNewConversation,children:\"Nueva Conversaci\\xF3n\"})]}),sidebarOpen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversations-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Chats\"}),/*#__PURE__*/_jsx(\"div\",{className:\"conversations-list\",children:conversations.map(conv=>/*#__PURE__*/_jsx(\"div\",{className:\"conversation-item \".concat(activeConversation===conv.id?'active':''),onClick:()=>setActiveConversation(conv.id),children:conv.title},conv.id))}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"new-chat-btn\",onClick:async()=>{setActionMsg('Sincronizando Drive...');try{const r=await syncDrive();setActionMsg(\"Descargados: \".concat((r.downloaded||[]).length,\", Omitidos: \").concat((r.skipped||[]).length));}catch(e){setActionMsg('Error al sincronizar Drive');}},children:\"Sync Drive\"}),/*#__PURE__*/_jsxs(\"label\",{style:{display:'block',marginTop:8},children:[\"Subir PDF\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"application/pdf\",onChange:async ev=>{var _ev$target$files;const f=(_ev$target$files=ev.target.files)===null||_ev$target$files===void 0?void 0:_ev$target$files[0];if(!f)return;setActionMsg('Subiendo/ingestando PDF...');try{const r=await uploadPdf(f);setActionMsg(\"Chunks agregados: \".concat(r.chunks_added));}catch(e){setActionMsg('Error al subir/ingerir');}ev.target.value='';}})]}),actionMsg&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:6,fontSize:12},children:actionMsg})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:onLogout,children:\"Cerrar Sesi\\xF3n\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Asistente RAG Inteligente\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"messages-container\",children:messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-message\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"welcome-icon\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\xA1Hola! Soy tu asistente para consultar documentaci\\xF3n\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Preg\\xFAntame lo que necesites sobre los documentos disponibles\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[messages.map(msg=>/*#__PURE__*/_jsxs(\"div\",{className:\"message \".concat(msg.sender,\"-message\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:msg.sender==='user'?'üë§':'ü§ñ'}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-text\",children:msg.text}),msg.sources&&msg.sources.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-sources\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sources-header\",children:[\"\\uD83D\\uDCC4 Fuentes consultadas (\",msg.sources.length,\") \\u25BC\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"sources-list\",children:msg.sources.map((source,idx)=>{var _source$metadata;return/*#__PURE__*/_jsxs(\"div\",{className:\"source-item\",children:[\"\\uD83D\\uDD17 \",((_source$metadata=source.metadata)===null||_source$metadata===void 0?void 0:_source$metadata.source)||\"Fuente \".concat(idx+1)]},idx);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-time\",children:[\"\\u23F0 \",msg.timestamp]}),msg.sender==='bot'&&!msg.isError&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-feedback\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\xBFTe ayud\\xF3 esta respuesta?\"}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-btn\",children:\"\\uD83D\\uDC4D\"}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-btn\",children:\"\\uD83D\\uDC4E\"})]})]})]},msg.id)),isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message bot-message\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-avatar\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"div\",{className:\"message-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"typing-indicator\",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(\"span\",{})]})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"input-container\",children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,className:\"input-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-wrapper\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:message,onChange:e=>setMessage(e.target.value),placeholder:\"Ingresa tu consulta\",className:\"message-input\",rows:\"1\",onKeyDown:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",disabled:isLoading||!message.trim(),children:\"\\u2708\\uFE0F\"})]})})})]})]});};export default Chat;","map":{"version":3,"names":["React","useState","useRef","useEffect","query","queryApi","syncDrive","uploadPdf","getConversations","getMessages","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chat","_ref","onLogout","message","setMessage","messages","setMessages","isLoading","setIsLoading","conversations","setConversations","activeConversation","setActiveConversation","sidebarOpen","setSidebarOpen","actionMsg","setActionMsg","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","res","list","length","id","e","console","error","msgs","map","m","text","sender","timestamp","Date","created_at","toLocaleTimeString","handleSubmit","preventDefault","trim","userMessage","now","prev","response","undefined","botMessage","answer","sources","conversation_id","r","_unused","errorMessage","isError","startNewConversation","className","children","concat","onClick","conv","title","style","padding","downloaded","skipped","display","marginTop","type","accept","onChange","ev","_ev$target$files","f","target","files","chunks_added","value","fontSize","msg","source","idx","_source$metadata","metadata","ref","onSubmit","placeholder","rows","onKeyDown","key","shiftKey","disabled"],"sources":["C:/Users/amaya/Downloads/rag-asistente-main/rag-asistente-main/frontend-react/src/Chat.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { query as queryApi, syncDrive, uploadPdf, getConversations, getMessages } from './api';\r\n\r\nconst Chat = ({ onLogout }) => {\r\n  const [message, setMessage] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [conversations, setConversations] = useState([]);\r\n  const [activeConversation, setActiveConversation] = useState(null);\r\n  const [sidebarOpen, setSidebarOpen] = useState(true);\r\n  const [actionMsg, setActionMsg] = useState(\"\");\r\n  const messagesEndRef = useRef(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  useEffect(() => { scrollToBottom(); }, [messages]);\r\n\r\n  // Cargar conversaciones al montar\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const res = await getConversations();\r\n        const list = res.conversations || [];\r\n        setConversations(list);\r\n        if (list.length > 0) setActiveConversation(list[0].id);\r\n      } catch (e) {\r\n        console.error('No se pudieron cargar conversaciones', e);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  // Cargar mensajes al cambiar de conversaci√≥n\r\n  useEffect(() => {\r\n    if (!activeConversation) { setMessages([]); return; }\r\n    (async () => {\r\n      try {\r\n        const res = await getMessages(activeConversation);\r\n        const msgs = (res.messages || []).map(m => ({\r\n          id: m.id,\r\n          text: m.text,\r\n          sender: m.sender,\r\n          timestamp: new Date(m.created_at).toLocaleTimeString()\r\n        }));\r\n        setMessages(msgs);\r\n      } catch (e) {\r\n        console.error('No se pudieron cargar mensajes', e);\r\n        setMessages([]);\r\n      }\r\n    })();\r\n  }, [activeConversation]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!message.trim()) return;\r\n\r\n    const userMessage = { \r\n      id: Date.now(), \r\n      text: message, \r\n      sender: 'user', \r\n      timestamp: new Date().toLocaleTimeString()\r\n    };\r\n    \r\n    setMessages(prev => [...prev, userMessage]);\r\n    setMessage('');\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      const response = await queryApi(message, 5, activeConversation || undefined);\r\n      const botMessage = {\r\n        id: Date.now() + 1,\r\n        text: response.answer,\r\n        sender: 'bot',\r\n        timestamp: new Date().toLocaleTimeString(),\r\n        sources: response.sources || []\r\n      };\r\n      setMessages(prev => [...prev, botMessage]);\r\n      // Actualizar conversaci√≥n activa si el backend la cre√≥\r\n      if (!activeConversation && response.conversation_id) {\r\n        setActiveConversation(response.conversation_id);\r\n        // refrescar lista de conversaciones\r\n        try { const r = await getConversations(); setConversations(r.conversations || []); } catch {}\r\n      }\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      const errorMessage = {\r\n        id: Date.now() + 1,\r\n        text: 'Error al procesar la consulta. Intenta nuevamente.',\r\n        sender: 'bot',\r\n        timestamp: new Date().toLocaleTimeString(),\r\n        isError: true\r\n      };\r\n      setMessages(prev => [...prev, errorMessage]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const startNewConversation = () => {\r\n    setMessages([]);\r\n    setActiveConversation(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-container\">\r\n      {/* Sidebar */}\r\n      <div className={`sidebar ${sidebarOpen ? 'open' : 'closed'}`}>\r\n        <div className=\"sidebar-header\">\r\n          <button className=\"toggle-sidebar\" onClick={() => setSidebarOpen(!sidebarOpen)}>\r\n            {sidebarOpen ? '‚Üê' : '‚Üí'}\r\n          </button>\r\n          {sidebarOpen && (\r\n            <button className=\"new-chat-btn\" onClick={startNewConversation}>\r\n              Nueva Conversaci√≥n\r\n            </button>\r\n          )}\r\n        </div>\r\n        \r\n        {sidebarOpen && (\r\n          <>\r\n            <div className=\"conversations-section\">\r\n              <h4>Chats</h4>\r\n              <div className=\"conversations-list\">\r\n                {conversations.map(conv => (\r\n                  <div\r\n                    key={conv.id}\r\n                    className={`conversation-item ${activeConversation === conv.id ? 'active' : ''}`}\r\n                    onClick={() => setActiveConversation(conv.id)}\r\n                  >\r\n                    {conv.title}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <div style={{padding:'10px'}}>\r\n                <button className=\"new-chat-btn\" onClick={async ()=>{\r\n                  setActionMsg('Sincronizando Drive...');\r\n                  try { const r = await syncDrive(); setActionMsg(`Descargados: ${(r.downloaded||[]).length}, Omitidos: ${(r.skipped||[]).length}`); } catch(e){ setActionMsg('Error al sincronizar Drive'); }\r\n                }}>Sync Drive</button>\r\n                <label style={{display:'block', marginTop:8}}>\r\n                  Subir PDF\r\n                  <input type=\"file\" accept=\"application/pdf\" onChange={async (ev)=>{\r\n                    const f = ev.target.files?.[0]; if(!f) return;\r\n                    setActionMsg('Subiendo/ingestando PDF...');\r\n                    try { const r = await uploadPdf(f); setActionMsg(`Chunks agregados: ${r.chunks_added}`); } catch(e){ setActionMsg('Error al subir/ingerir'); }\r\n                    ev.target.value = '';\r\n                  }}/>\r\n                </label>\r\n                {actionMsg && <div style={{marginTop:6, fontSize:12}}>{actionMsg}</div>}\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"sidebar-footer\">\r\n              <button className=\"logout-btn\" onClick={onLogout}>\r\n                Cerrar Sesi√≥n\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Chat Area */}\r\n      <div className=\"chat-main\">\r\n        <div className=\"chat-header\">\r\n          <h1>Asistente RAG Inteligente</h1>\r\n        </div>\r\n\r\n        <div className=\"messages-container\">\r\n          {messages.length === 0 ? (\r\n            <div className=\"welcome-message\">\r\n              <div className=\"welcome-icon\">ü§ñ</div>\r\n              <h2>¬°Hola! Soy tu asistente para consultar documentaci√≥n</h2>\r\n              <p>Preg√∫ntame lo que necesites sobre los documentos disponibles</p>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {messages.map(msg => (\r\n                <div key={msg.id} className={`message ${msg.sender}-message`}>\r\n                  <div className=\"message-avatar\">\r\n                    {msg.sender === 'user' ? 'üë§' : 'ü§ñ'}\r\n                  </div>\r\n                  <div className=\"message-content\">\r\n                    <div className=\"message-text\">\r\n                      {msg.text}\r\n                    </div>\r\n                    {msg.sources && msg.sources.length > 0 && (\r\n                      <div className=\"message-sources\">\r\n                        <div className=\"sources-header\">\r\n                          üìÑ Fuentes consultadas ({msg.sources.length}) ‚ñº\r\n                        </div>\r\n                        <div className=\"sources-list\">\r\n                          {msg.sources.map((source, idx) => (\r\n                            <div key={idx} className=\"source-item\">\r\n                              üîó {source.metadata?.source || `Fuente ${idx + 1}`}\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    <div className=\"message-time\">\r\n                      ‚è∞ {msg.timestamp}\r\n                    </div>\r\n                    {msg.sender === 'bot' && !msg.isError && (\r\n                      <div className=\"message-feedback\">\r\n                        <span>¬øTe ayud√≥ esta respuesta?</span>\r\n                        <button className=\"feedback-btn\">üëç</button>\r\n                        <button className=\"feedback-btn\">üëé</button>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              {isLoading && (\r\n                <div className=\"message bot-message\">\r\n                  <div className=\"message-avatar\">ü§ñ</div>\r\n                  <div className=\"message-content\">\r\n                    <div className=\"typing-indicator\">\r\n                      <span></span>\r\n                      <span></span>\r\n                      <span></span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <div ref={messagesEndRef} />\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"input-container\">\r\n          <form onSubmit={handleSubmit} className=\"input-form\">\r\n            <div className=\"input-wrapper\">\r\n              <textarea\r\n                value={message}\r\n                onChange={(e) => setMessage(e.target.value)}\r\n                placeholder=\"Ingresa tu consulta\"\r\n                className=\"message-input\"\r\n                rows=\"1\"\r\n                onKeyDown={(e) => {\r\n                  if (e.key === 'Enter' && !e.shiftKey) {\r\n                    e.preventDefault();\r\n                    handleSubmit(e);\r\n                  }\r\n                }}\r\n              />\r\n              <button \r\n                type=\"submit\" \r\n                className=\"send-button\"\r\n                disabled={isLoading || !message.trim()}\r\n              >\r\n                ‚úàÔ∏è\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}